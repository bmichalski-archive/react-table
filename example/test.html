<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>React table test</title>
    <link rel="stylesheet" type="text/css" href="../node_modules/bootstrap/dist/css/bootstrap.css" />
    <script type="text/javascript" src="../node_modules/react/dist/react.js"></script>
    <script type="text/javascript" src="../node_modules/react-dom/dist/react-dom.js"></script>
    <script type="text/javascript" src="../node_modules/react-router/umd/ReactRouter.js"></script>
    <script type="text/javascript" src="../node_modules/underscore/underscore.js"></script>
    <script type="text/javascript" src="../node_modules/babel-standalone/babel.js"></script>
    <script type="text/javascript" src="../node_modules/bluebird/js/browser/bluebird.js"></script>
    <script type="text/javascript" src="../dist/Table.min.js"></script>
    <script type="text/javascript" src="./sample-result.js"></script>
    <style type="text/css">
        .pagination > li.current > a {
            background-color: #eee;
        }

        .pagination > li > a {
            min-width: 50px;
            text-align: center;
        }

        .table > tbody > tr > td {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="row-clicked">Row clicked: </div>
    <div id="main-container" class="container-fluid"></div>
    <script type="text/babel">
        class TableWrapper extends React.Component {
            constructor(props) {
                super(props)

                this.paginator = new ReactRouterPaginator(this.props.location)
            }

            componentWillReceiveProps(newProps) {
                this.paginator.location = newProps.location
            }

            getData() {
                const from = (this.paginator.page - 1) * this.paginator.pageSize
                const end = from + this.paginator.pageSize

                return new Promise((resolve) => {
                    resolve({
                        result: sampleResult.slice(from, end),
                        info: {
                            total: sampleResult.length * 2,
                            totalFiltered: sampleResult.length
                        }
                    })
                })
            }

            static onRowClicked (data, rowIndex) {
                const str = JSON.stringify({ rowIndex: rowIndex, data: data })

                document
                    .getElementById('row-clicked')
                    .innerHTML = 'Row clicked: ' + str
            }

            render() {
                return (
                    <Table
                        onRowClicked={TableWrapper.onRowClicked}
                        getData={this.getData.bind(this)}
                        renderCell={(data) => { return data.content }}
                        paginator={this.paginator}>
                        <TableHead>
                            <TableHeadRow>
                                <TableHeadTh>Id</TableHeadTh>
                                <TableHeadTh>First column</TableHeadTh>
                                <TableHeadTh>Second column</TableHeadTh>
                            </TableHeadRow>
                        </TableHead>
                    </Table>
                )
            }
        }

        const Router = ReactRouter.Router
        const Route = ReactRouter.Route

        ReactDOM.render(
            (
                <Router history={ReactRouter.browserHistory}>
                    <Route path="/" component={TableWrapper}>
                        <Route path="*" component={TableWrapper} />
                    </Route>
                </Router>
            ),
            document.getElementById('main-container')
        )
    </script>
</body>
</html>
